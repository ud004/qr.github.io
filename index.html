<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SharePoint Redirect</title>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // SharePoint URL 리스트 설정
            const baseUrls = [
                "https://hallagroup.sharepoint.com/:x:/s/00005.10GMN000000204/EbppxfJA7T1GkfVmqWAHda0BffSHf-B4ZJqw4vhe5uK-9w?e=fsdxdL",
                "https://hallagroup.sharepoint.com/:x:/s/00005.10GMN000000204/ER23VIJ8qS5OgEbO0Ht0L8kBQTl70FYX3OZ3_ubh1dsluA?e=4jPMKQ"
            ];

            // URL 파라미터 가져오기
            const urlParams = new URLSearchParams(window.location.search);
            const idx = urlParams.get('i');
            const pjt = urlParams.get('p');

            // 디버깅용 콘솔 로그
            console.log('URL Parameters:', urlParams.toString());
            console.log('Index:', idx);
            console.log('Project:', pjt);
            console.log('baseUrls Length:', baseUrls.length);

            // 기본값 설정 및 유효성 검사
            redirectUrl = (idx >= 0 && idx < baseUrls.length) ? baseUrls[idx] : baseUrls[0];

            console.log('Redirect URL:', redirectUrl);

            // ActiveCell 파라미터 추가
            if (pjt) {
                console.log('test')
                redirectUrl += `&ActiveCell=${encodeURIComponent(pjt)}!A1`;
                console.log('test')
            }

            // 디버깅용 콘솔 로그
            console.log('Redirect URL:', redirectUrl);

            // 리디렉션 수행
            window.location.href = redirectUrl;
        });
    </script>
</head>
<body>
    <p>Redirecting to SharePoint...</p>
</body>
</html>
